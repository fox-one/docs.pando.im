"use strict";(self.webpackChunkpando_docs=self.webpackChunkpando_docs||[]).push([[4744],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>g});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),u=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(r),m=a,g=c["".concat(l,".").concat(m)]||c[m]||d[m]||o;return r?n.createElement(g,i(i({ref:t},p),{},{components:r})):n.createElement(g,i({ref:t},p))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,i[1]=s;for(var u=2;u<o;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},245:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>u});var n=r(7462),a=(r(7294),r(3905));const o={title:"Using SDK to Trade",date:new Date("2021-07-22T22:33:07.000Z")},i=void 0,s={unversionedId:"lake/guide/using-sdk",id:"lake/guide/using-sdk",title:"Using SDK to Trade",description:"By default, Pando Lake uses 4swap as the liquidity provider. It's easy to exchange assets at Pando Lake by 4swap's SDK.",source:"@site/i18n/es/docusaurus-plugin-content-docs-developer/current/lake/guide/using-sdk.md",sourceDirName:"lake/guide",slug:"/lake/guide/using-sdk",permalink:"/es/developer/lake/guide/using-sdk",draft:!1,tags:[],version:"current",lastUpdatedAt:1664291639,formattedLastUpdatedAt:"27 sept 2022",frontMatter:{title:"Using SDK to Trade",date:"2021-07-22T22:33:07.000Z"},sidebar:"docs",previous:{title:"Overview",permalink:"/es/developer/lake/overview"},next:{title:"Invoke Wallets",permalink:"/es/developer/lake/guide/invoke-wallets"}},l={},u=[{value:"Import 4swap SDK into your project",id:"import-4swap-sdk-into-your-project",level:2},{value:"Get the multisig group information",id:"get-the-multisig-group-information",level:2},{value:"Get all tradable pairs",id:"get-all-tradable-pairs",level:2},{value:"Calculate the best route to trade",id:"calculate-the-best-route-to-trade",level:2},{value:"Construct a real order",id:"construct-a-real-order",level:2},{value:"Place an order programmatically",id:"place-an-order-programmatically",level:2}],p={toc:u};function c(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"By default, Pando Lake uses 4swap as the liquidity provider. It's easy to exchange assets at Pando Lake by 4swap's SDK."),(0,a.kt)("h2",{id:"import-4swap-sdk-into-your-project"},"Import 4swap SDK into your project"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'import (\n    fswap "github.com/fox-one/4swap-sdk-go"\n    mtg "github.com/fox-one/4swap-sdk-go/mtg"\n    "github.com/fox-one/mixin-sdk-go"\n    "github.com/shopspring/decimal"\n)\n')),(0,a.kt)("h2",{id:"get-the-multisig-group-information"},"Get the multisig group information"),(0,a.kt)("p",null,"When you perform operations at Pando Lake, such as swapping crypto, adding liquidity, and removing liquidity, you must create multisig transactions and interact with Mixin Network."),(0,a.kt)("p",null,"The participants of each multisig are also the members of MTG. So please read them first and save them for later use."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"ctx := context.TODO()\n\n// use the 4swap's MTG api endpoint\nfswap.UseEndpoint(fswap.MtgEndpoint)\n\n// read the mtg group\n// the group information would change frequently\n// it's recommended to save it for later use\ngroup, err := fswap.ReadGroup(ctx)\nif err != nil {\n    return err\n}\n...\n")),(0,a.kt)("h2",{id:"get-all-tradable-pairs"},"Get all tradable pairs"),(0,a.kt)("p",null,"To get all supported asset pairs is easy:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"pairs, err := fswap.ListPairs(ctx)\nif err != nil {\n    return err\n}\n...\n")),(0,a.kt)("h2",{id:"calculate-the-best-route-to-trade"},"Calculate the best route to trade"),(0,a.kt)("p",null,"Before swapping cryptos, we need to specify the swapping route."),(0,a.kt)("p",null,"At present, you may let Lake decide the route, but it may cause the performance issues and slow down the bot. Because of that, it is recommended to calculate a swapping route yourself."),(0,a.kt)("p",null,"To calculate route is easy. Sort the pairs according to the liquidity and call ",(0,a.kt)("inlineCode",{parentName:"p"},"Route")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"ReverseRoute")," methods, which will return an ",(0,a.kt)("inlineCode",{parentName:"p"},"order")," object that includes the result of calculation."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'// sort first\nsort.Slice(pairs, func(i, j int) bool {\n    aLiquidity := pairs[i].BaseValue.Add(pairs[i].QuoteValue)\n    bLiquidity := pairs[j].BaseValue.Add(pairs[j].QuoteValue)\n    return aLiquidity.GreaterThan(bLiquidity)\n})\n\n// calculate the route\n// InputAssetID - the id of the asset you want to paid\n// OutputAssetID - the id of the asset you trade for\n// InputAmount - the amount to calucate the route, for example, 1000\npreOrder, err := fswap.Route(pairs, InputAssetID, OutputAssetID, InputAmount)\nif err != nil {\n    return err\n}\n\n// you can read the best route from Order.RouteAssets, which is an array of asset_id\nlog.Printf("Route: %v", preOrder.RouteAssets)\nlog.Printf("Price: %v", preOrder.FillAmount.Div(InputAmount))\n...\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"If you don't use 4swap SDK, you can implement your own best route algorithm (",(0,a.kt)("a",{parentName:"p",href:"https://github.com/fox-one/4swap-sdk-go/blob/master/route.go"},"golang version"),", ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/fox-one/4swap-web/blob/develop/src/utils/pair/route.ts"},"javascript version"),").")),(0,a.kt)("h2",{id:"construct-a-real-order"},"Construct a real order"),(0,a.kt)("p",null,"All required information about an order is stored in the transaction memo, in JSON format:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "action": "3,${receiver_id},${follow_id},${fill_asset_id},${routes},${minimum}"\n}\n')),(0,a.kt)("p",null,"in which,"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"{receiver_id} is the id of user who will receive the LP-Token"),(0,a.kt)("li",{parentName:"ul"},"{follow_id} is a UUID to trace the transfer, use it to query ",(0,a.kt)("a",{parentName:"li",href:"/es/developer/lake/apis/orders"},"this API"),"."),(0,a.kt)("li",{parentName:"ul"},"{fill_asset_id} is the asset's ID for which you are swapping."),(0,a.kt)("li",{parentName:"ul"},"{routes} is a route ids' sequence, which indicates which route you want to use."),(0,a.kt)("li",{parentName:"ul"},"{minimum} is the minimum amount of asset you will get")),(0,a.kt)("p",null,"If you are using 4swap SDK, you can also use the method ",(0,a.kt)("inlineCode",{parentName:"p"},"mtg.SwapAction")," to simplify the process:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'// the ID to trace the orders\nfollowID, _ := uuid.NewV4()\n\n// build a swap action, specified the parameters\naction := mtg.SwapAction(\n    receiverID,\n    followID.String(),\n    OutputAssetID,\n    preOrder.Routes,\n    // the minimum amount of asset you will get.\n    // you may want to change this value to a number which less than preOrder.FillAmount\n    preOrder.FillAmount.Div(decimal.NewFromFloat(0.005)),\n)\n\n// generate the memo\nmemo, err := action.Encode(group.PublicKey)\nif err != nil {\n    return err\n}\nlog.Println("memo", memo)\n...\n\n')),(0,a.kt)("h2",{id:"place-an-order-programmatically"},"Place an order programmatically"),(0,a.kt)("p",null,"If you want the bot to place an order, send a multisig transaction from the bot."),(0,a.kt)("p",null,"This is a common scene for arbitrage bot. Please make sure the bot has enough crypto in the bot's wallet."),(0,a.kt)("p",null,"We need to use ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/fox-one/mixin-sdk-go"},"mixin-sdk-go")," client to create and send the transaction to the kernel nodes."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'// send a transaction to a multi-sign address which specified by `OpponentMultisig`\n// the OpponentMultisig.Receivers are the MTG group members\ntx, err := client.Transaction(ctx, &mixin.TransferInput{\n    AssetID: payAssetID,\n    Amount:  decimal.RequireFromString(amount),\n    TraceID: mixin.RandomTraceID(),\n    Memo:    memo,\n    OpponentMultisig: struct {\n        Receivers []string `json:"receivers,omitempty"`\n        Threshold uint8    `json:"threshold,omitempty"`\n    }{\n        Receivers: group.Members,\n        Threshold: uint8(group.Threshold),\n    },\n}, *pin)\n')))}c.isMDXComponent=!0}}]);